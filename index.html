<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Simulasi Deposito</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen p-6">
  <div class="max-w-3xl mx-auto bg-white shadow-xl rounded-xl p-6">
    <h1 class="text-2xl font-bold mb-4 text-center">Simulasi Deposito</h1>

    <!-- Form Input -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
      <div>
        <label class="block text-sm font-medium mb-1">Nominal (Plafon)</label>
        <input id="plafon" type="text" class="w-full border rounded-lg p-2" placeholder="1.000.000">
      </div>
      <div>
        <label class="block text-sm font-medium mb-1">Suku Bunga (% per tahun)</label>
        <input id="bunga" type="number" step="0.01" class="w-full border rounded-lg p-2" placeholder="5">
      </div>
      <div>
        <label class="block text-sm font-medium mb-1">Jenis Bunga</label>
        <select id="jenis" class="w-full border rounded-lg p-2">
          <option value="bulanan">Bulanan (dibayar ke rekening)</option>
          <option value="capitalized">Capitalized (bunga berbunga)</option>
        </select>
      </div>
      <div>
        <label class="block text-sm font-medium mb-1">Tenor (bulan)</label>
        <input id="tenor" type="number" class="w-full border rounded-lg p-2" placeholder="12">
      </div>
    </div>

    <div class="flex justify-center mb-6">
      <button onclick="hitungDeposito()" class="bg-blue-600 hover:bg-blue-700 text-white font-medium px-6 py-2 rounded-lg">
        Hitung
      </button>
    </div>

    <!-- Hasil -->
    <div id="hasil" class="hidden bg-gray-50 p-4 rounded-lg border">
      <p class="text-sm text-red-600 mb-2">
        Perhitungan di bawah belum termasuk biaya administrasi, pajak bunga, dan lain-lain
      </p>
      <h2 class="text-lg font-semibold mb-2">Hasil Simulasi</h2>
      <div class="space-y-1">
        <div class="flex">
          <span class="w-56">Nominal (Plafon)</span><span>:</span>&nbsp;
          <span id="outPlafon"></span>
        </div>
        <div class="flex">
          <span class="w-56">Total Bunga</span><span>:</span>&nbsp;
          <span id="totalBunga"></span>
        </div>
        <div class="flex">
          <span class="w-56">Saldo Akhir</span><span>:</span>&nbsp;
          <span id="saldoAkhir"></span>
        </div>
        <div class="flex">
          <span class="w-56">Bunga per Bulan</span><span>:</span>&nbsp;
          <span id="bungaPerBulan"></span>
        </div>
      </div>
    </div>

    <!-- Tabel -->
    <div id="tabelWrap" class="hidden mt-6">
      <h2 class="text-lg font-semibold mb-2 flex justify-between items-center">
        <span>Tabel Simulasi</span>
        <button onclick="window.print()" id="btnCetak" class="hidden bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded-lg text-sm">
          Cetak
        </button>
      </h2>
      <div class="overflow-x-auto">
        <table class="min-w-full border border-gray-200 text-sm text-right">
          <thead class="bg-gray-100">
            <tr>
              <th class="border px-2 py-1 text-left">Bulan</th>
              <th class="border px-2 py-1">Bunga Bulan Ini</th>
              <th class="border px-2 py-1">Akumulasi Bunga</th>
              <th class="border px-2 py-1">Saldo Akhir</th>
            </tr>
          </thead>
          <tbody id="tabelBody"></tbody>
        </table>
      </div>
    </div>
  </div>

  <script>
    function fmt(num) {
      return new Intl.NumberFormat('id-ID').format(Math.round(num));
    }

    // Format input plafon dengan titik ribuan saat mengetik
    var plafonInput = document.getElementById('plafon');
    plafonInput.addEventListener('input', function(e) {
      var value = this.value.replace(/\D/g, "");
      this.value = value ? new Intl.NumberFormat('id-ID').format(value) : "";
    });
    function getPlafonValue() {
      return parseFloat(plafonInput.value.replace(/\./g, "").replace(/,/g, "")) || 0;
    }

    function hitungDeposito() {
      var nominal = getPlafonValue();
      var tenor = parseInt(document.getElementById('tenor').value) || 0;
      var bungaTahunan = parseFloat(document.getElementById('bunga').value) || 0;
      var jenis = document.getElementById('jenis').value;

      if (nominal <= 0 || tenor <= 0 || bungaTahunan < 0) {
        alert("Masukkan data yang benar!");
        return;
      }

      var rBulanan = bungaTahunan / 12 / 100;

      var tbody = document.getElementById('tabelBody');
      tbody.innerHTML = "";
      var akumulasi = 0;
      var saldo = nominal;

      if (jenis === "bulanan") {
        // Bunga dibayar tiap bulan, pokok tidak berubah
        var bungaTetap = nominal * rBulanan;
        for (var i = 1; i <= tenor; i++) {
          akumulasi += bungaTetap;
          var row = "<tr>" +
            "<td class='border px-2 py-1 text-left'>" + i + "</td>" +
            "<td class='border px-2 py-1'>" + fmt(bungaTetap) + "</td>" +
            "<td class='border px-2 py-1'>" + fmt(akumulasi) + "</td>" +
            "<td class='border px-2 py-1'>" + fmt(saldo) + "</td>" +
          "</tr>";
          tbody.innerHTML += row;
        }
      } else {
        // Capitalized: bunga ditambahkan ke saldo tiap bulan (compound)
        for (var j = 1; j <= tenor; j++) {
          var bungaBulanIni = saldo * rBulanan;
          akumulasi += bungaBulanIni;
          saldo += bungaBulanIni;
          var rowC = "<tr>" +
            "<td class='border px-2 py-1 text-left'>" + j + "</td>" +
            "<td class='border px-2 py-1'>" + fmt(bungaBulanIni) + "</td>" +
            "<td class='border px-2 py-1'>" + fmt(akumulasi) + "</td>" +
            "<td class='border px-2 py-1'>" + fmt(saldo) + "</td>" +
          "</tr>";
          tbody.innerHTML += rowC;
        }
      }

      // Ringkasan
      var totalBunga = akumulasi;
      var saldoAkhir = (jenis === "bulanan") ? nominal : saldo;
      var bungaPerBulan = (jenis === "bulanan") ? (nominal * rBulanan) : (totalBunga / tenor);

      document.getElementById('hasil').classList.remove('hidden');
      document.getElementById('outPlafon').innerText = "Rp " + fmt(nominal);
      document.getElementById('totalBunga').innerText = "Rp " + fmt(totalBunga);
      document.getElementById('saldoAkhir').innerText = "Rp " + fmt(saldoAkhir);
      document.getElementById('bungaPerBulan').innerText = "Rp " + fmt(bungaPerBulan);

      document.getElementById('tabelWrap').classList.remove('hidden');
      document.getElementById('btnCetak').classList.remove('hidden');
    }
  </script>
</body>
</html>
